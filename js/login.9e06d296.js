(self["webpackChunkbyerun"]=self["webpackChunkbyerun"]||[]).push([[966],{2151:function(e){var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};e.exports=t},3939:function(e){(function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,a=0;n<e.length;n++,a+=8)t[a>>>5]|=e[n]<<24-a%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var n=[],a=0;a<e.length;a+=3)for(var r=e[a]<<16|e[a+1]<<8|e[a+2],o=0;o<4;o++)8*a+6*o<=8*e.length?n.push(t.charAt(r>>>6*(3-o)&63)):n.push("=");return n.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],a=0,r=0;a<e.length;r=++a%4)0!=r&&n.push((t.indexOf(e.charAt(a-1))&Math.pow(2,-2*r+8)-1)<<2*r|t.indexOf(e.charAt(a))>>>6-2*r);return n}};e.exports=n})()},7206:function(e){function t(e){return!!e.constructor&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function n(e){return"function"===typeof e.readFloatLE&&"function"===typeof e.slice&&t(e.slice(0,0))}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(t(e)||n(e)||!!e._isBuffer)}},3503:function(e,t,n){(function(){var t=n(3939),a=n(2151).utf8,r=n(7206),o=n(2151).bin,l=function(e,n){e.constructor==String?e=n&&"binary"===n.encoding?o.stringToBytes(e):a.stringToBytes(e):r(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var u=t.bytesToWords(e),s=8*e.length,i=1732584193,c=-271733879,d=-1732584194,f=271733878,g=0;g<u.length;g++)u[g]=16711935&(u[g]<<8|u[g]>>>24)|4278255360&(u[g]<<24|u[g]>>>8);u[s>>>5]|=128<<s%32,u[14+(s+64>>>9<<4)]=s;var p=l._ff,v=l._gg,y=l._hh,h=l._ii;for(g=0;g<u.length;g+=16){var b=i,k=c,m=d,_=f;i=p(i,c,d,f,u[g+0],7,-680876936),f=p(f,i,c,d,u[g+1],12,-389564586),d=p(d,f,i,c,u[g+2],17,606105819),c=p(c,d,f,i,u[g+3],22,-1044525330),i=p(i,c,d,f,u[g+4],7,-176418897),f=p(f,i,c,d,u[g+5],12,1200080426),d=p(d,f,i,c,u[g+6],17,-1473231341),c=p(c,d,f,i,u[g+7],22,-45705983),i=p(i,c,d,f,u[g+8],7,1770035416),f=p(f,i,c,d,u[g+9],12,-1958414417),d=p(d,f,i,c,u[g+10],17,-42063),c=p(c,d,f,i,u[g+11],22,-1990404162),i=p(i,c,d,f,u[g+12],7,1804603682),f=p(f,i,c,d,u[g+13],12,-40341101),d=p(d,f,i,c,u[g+14],17,-1502002290),c=p(c,d,f,i,u[g+15],22,1236535329),i=v(i,c,d,f,u[g+1],5,-165796510),f=v(f,i,c,d,u[g+6],9,-1069501632),d=v(d,f,i,c,u[g+11],14,643717713),c=v(c,d,f,i,u[g+0],20,-373897302),i=v(i,c,d,f,u[g+5],5,-701558691),f=v(f,i,c,d,u[g+10],9,38016083),d=v(d,f,i,c,u[g+15],14,-660478335),c=v(c,d,f,i,u[g+4],20,-405537848),i=v(i,c,d,f,u[g+9],5,568446438),f=v(f,i,c,d,u[g+14],9,-1019803690),d=v(d,f,i,c,u[g+3],14,-187363961),c=v(c,d,f,i,u[g+8],20,1163531501),i=v(i,c,d,f,u[g+13],5,-1444681467),f=v(f,i,c,d,u[g+2],9,-51403784),d=v(d,f,i,c,u[g+7],14,1735328473),c=v(c,d,f,i,u[g+12],20,-1926607734),i=y(i,c,d,f,u[g+5],4,-378558),f=y(f,i,c,d,u[g+8],11,-2022574463),d=y(d,f,i,c,u[g+11],16,1839030562),c=y(c,d,f,i,u[g+14],23,-35309556),i=y(i,c,d,f,u[g+1],4,-1530992060),f=y(f,i,c,d,u[g+4],11,1272893353),d=y(d,f,i,c,u[g+7],16,-155497632),c=y(c,d,f,i,u[g+10],23,-1094730640),i=y(i,c,d,f,u[g+13],4,681279174),f=y(f,i,c,d,u[g+0],11,-358537222),d=y(d,f,i,c,u[g+3],16,-722521979),c=y(c,d,f,i,u[g+6],23,76029189),i=y(i,c,d,f,u[g+9],4,-640364487),f=y(f,i,c,d,u[g+12],11,-421815835),d=y(d,f,i,c,u[g+15],16,530742520),c=y(c,d,f,i,u[g+2],23,-995338651),i=h(i,c,d,f,u[g+0],6,-198630844),f=h(f,i,c,d,u[g+7],10,1126891415),d=h(d,f,i,c,u[g+14],15,-1416354905),c=h(c,d,f,i,u[g+5],21,-57434055),i=h(i,c,d,f,u[g+12],6,1700485571),f=h(f,i,c,d,u[g+3],10,-1894986606),d=h(d,f,i,c,u[g+10],15,-1051523),c=h(c,d,f,i,u[g+1],21,-2054922799),i=h(i,c,d,f,u[g+8],6,1873313359),f=h(f,i,c,d,u[g+15],10,-30611744),d=h(d,f,i,c,u[g+6],15,-1560198380),c=h(c,d,f,i,u[g+13],21,1309151649),i=h(i,c,d,f,u[g+4],6,-145523070),f=h(f,i,c,d,u[g+11],10,-1120210379),d=h(d,f,i,c,u[g+2],15,718787259),c=h(c,d,f,i,u[g+9],21,-343485551),i=i+b>>>0,c=c+k>>>0,d=d+m>>>0,f=f+_>>>0}return t.endian([i,c,d,f])};l._ff=function(e,t,n,a,r,o,l){var u=e+(t&n|~t&a)+(r>>>0)+l;return(u<<o|u>>>32-o)+t},l._gg=function(e,t,n,a,r,o,l){var u=e+(t&a|n&~a)+(r>>>0)+l;return(u<<o|u>>>32-o)+t},l._hh=function(e,t,n,a,r,o,l){var u=e+(t^n^a)+(r>>>0)+l;return(u<<o|u>>>32-o)+t},l._ii=function(e,t,n,a,r,o,l){var u=e+(n^(t|~a))+(r>>>0)+l;return(u<<o|u>>>32-o)+t},l._blocksize=16,l._digestsize=16,e.exports=function(e,n){if(void 0===e||null===e)throw new Error("Illegal argument "+e);var a=t.wordsToBytes(l(e,n));return n&&n.asBytes?a:n&&n.asString?o.bytesToString(a):t.bytesToHex(a)}})()},7655:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return T}});n(4114);var a=n(641),r=n(953),o=n(33),l=n(5220),u=n(163),s=n(2392),i=n(3503),c=n.n(i);const d=e=>c()(e).toLowerCase();var f=d,g=n(9378),p=n(9174);const v=(e,t)=>{const n=f(t),a={appVersion:p.w3,brand:p.qt,deviceToken:p.gx,deviceType:p.bq,mobileType:p.pn,password:n,sysVersion:p.uF,userPhone:e};return s.A.post(g.A.login,a)},y=e=>s.A.get(g.A.sendSms,{params:{phoneNum:e}}),h=(e,t,n)=>{const a=f(t),r={password:a,passwordRes:a,userPhone:e,code:n};return s.A.post(g.A.updatePassword,r)};function b(){const e=(0,r.KR)(!1),t=(0,l.rd)(),n=(0,r.KR)(!1),a=async(a,r)=>{e.value=!0;try{const e=await v(a,r);if(1e4===e.data.code){const o=JSON.parse(localStorage.getItem("accounts")||"[]");o.push({phone:a,password:r}),localStorage.setItem("accounts",JSON.stringify(o));const l=e.data.response.oauthToken.token,s=e.data.response;localStorage.setItem("token",l),localStorage.setItem("userData",JSON.stringify(s)),u.nk.success("登录成功"),n.value=!0,t.push("/user")}else u.nk.error("登录失败: "+e.data.msg)}catch(o){u.nk.error("登录失败: "+o.message)}finally{e.value=!1}},o=()=>{const e=localStorage.getItem("token"),t=localStorage.getItem("userData"),n=t?JSON.parse(t):null;return!(!e||!n)};return{LoginLoading:e,isLoggedIn:n,fetchLogin:a,LoginState:o}}function k(){const e=(0,r.KR)(!1),t=(0,r.KR)("获取验证码"),n=(0,r.KR)(!1),a=(e,t,n)=>{let a=e;const r=setInterval((()=>{a<=0?(clearInterval(r),n()):(a-=1,t(a))}),1e3)},o=async r=>{e.value=!0,t.value="正在发送";try{const e=await y(r);1e4===e.data.code?u.nk.success("验证码发送成功"):u.nk.error("验证码发送失败: "+e.data.msg)}catch(o){u.nk.error("验证码发送出错"+o.message),t.value="获取验证码",n.value=!1}finally{e.value=!1,a(60,(e=>{t.value=`${e} 秒后重新获取`,n.value=!0}),(()=>{t.value="获取验证码",n.value=!1}))}};return{SmsLoading:e,codeText:t,codeDisabled:n,fetchSendSMS:o}}function m(){const e=(0,r.KR)(!1),t=async(t,n,a)=>{e.value=!0;try{const e=await h(t,n,a);return 1e4===e.data.code?(u.nk.success("密码重置成功"),!0):(u.nk.error("密码重置失败: "+e.data.msg),!1)}catch(r){return console.error("密码重置出错: "+r.message),!1}finally{e.value=!1}};return{ResetLoading:e,fetchResetPassword:t}}const _=(0,a.Lk)("h1",null,"Byerun",-1),F={key:3,class:"footer-links"};var S={__name:"Login",setup(e){const t=g.A.opensrcURL,n=(0,l.rd)(),s=(0,r.KR)(!0),i=(0,r.KR)(!1),c=(0,r.KR)(""),d=(0,r.KR)(""),f=(0,r.KR)(""),p=(0,r.KR)(""),v=(0,r.KR)(""),{LoginLoading:y,isLoggedIn:h,fetchLogin:S,LoginState:R}=b(),{SmsLoading:T,codeText:w,codeDisabled:L,fetchSendSMS:W}=k(),{ResetLoading:V,fetchResetPassword:C}=m(),A=()=>{s.value=!1,i.value=!0},B=()=>!!/^1[3-9]\d{9}$/.test(c.value||f.value)||(u.nk.error("请输入正确的手机号"),!1),x=()=>{B()&&S(c.value,d.value)},I=()=>{B()&&W(f.value)},K=async()=>{if(B()){const e=await C(f.value,p.value,v.value);e&&(c.value=f.value,d.value=p.value,s.value=!0)}},U=()=>{n.push("/")},N=()=>{n.push("/dashboard")};return(0,a.nT)((()=>{h.value&&N()})),(0,a.sV)((async()=>{const e=await R();e&&N()})),(e,n)=>{const l=(0,a.g2)("el-header"),u=(0,a.g2)("el-input"),g=(0,a.g2)("el-form-item"),h=(0,a.g2)("el-button"),b=(0,a.g2)("el-form"),k=(0,a.g2)("el-text"),m=(0,a.g2)("el-link"),S=(0,a.g2)("el-space"),R=(0,a.g2)("el-main"),W=(0,a.g2)("el-container");return(0,a.uX)(),(0,a.Wv)(W,null,{default:(0,a.k6)((()=>[(0,a.bF)(l,null,{default:(0,a.k6)((()=>[_])),_:1}),(0,a.bF)(R,null,{default:(0,a.k6)((()=>[s.value?((0,a.uX)(),(0,a.Wv)(b,{key:0},{default:(0,a.k6)((()=>[(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(u,{modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=e=>c.value=e),placeholder:"请输入手机号"},null,8,["modelValue"])])),_:1}),(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(u,{modelValue:d.value,"onUpdate:modelValue":n[1]||(n[1]=e=>d.value=e),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])])),_:1}),(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(h,{type:"primary",onClick:x,loading:(0,r.R1)(y)},{default:(0,a.k6)((()=>[(0,a.eW)("立即登录")])),_:1},8,["loading"])])),_:1}),(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(h,{type:"default",onClick:U},{default:(0,a.k6)((()=>[(0,a.eW)("返回主页")])),_:1})])),_:1})])),_:1})):i.value?((0,a.uX)(),(0,a.Wv)(b,{key:1,class:"DisclaimerForm"},{default:(0,a.k6)((()=>[(0,a.bF)(S,{direction:"vertical"},{default:(0,a.k6)((()=>[(0,a.bF)(k,{tag:"b",size:"large"},{default:(0,a.k6)((()=>[(0,a.eW)("免责声明")])),_:1}),(0,a.bF)(k,null,{default:(0,a.k6)((()=>[(0,a.eW)("为了您的健康，不提倡长期使用。")])),_:1}),(0,a.bF)(k,null,{default:(0,a.k6)((()=>[(0,a.eW)("使用本工具所产生的任何后果，用户需自行承担。")])),_:1}),(0,a.bF)(k,null,{default:(0,a.k6)((()=>[(0,a.eW)("本工具仅供学习交流使用，不得用于任何商业用途。")])),_:1}),(0,a.bF)(m,{type:"primary",href:(0,r.R1)(t),target:"_blank"},{default:(0,a.k6)((()=>[(0,a.eW)("开源地址")])),_:1},8,["href"])])),_:1}),(0,a.bF)(h,{type:"primary",onClick:n[2]||(n[2]=e=>{s.value=!0,i.value=!1})},{default:(0,a.k6)((()=>[(0,a.eW)("返回登录")])),_:1})])),_:1})):((0,a.uX)(),(0,a.Wv)(b,{key:2},{default:(0,a.k6)((()=>[(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(u,{modelValue:f.value,"onUpdate:modelValue":n[3]||(n[3]=e=>f.value=e),placeholder:"请输入手机号",class:"phone-input"},null,8,["modelValue"]),(0,a.bF)(h,{type:"primary",onClick:I,disabled:(0,r.R1)(L),loading:(0,r.R1)(T),block:"",class:"sms-button"},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)((0,r.R1)(w)),1)])),_:1},8,["disabled","loading"])])),_:1}),(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(u,{modelValue:v.value,"onUpdate:modelValue":n[4]||(n[4]=e=>v.value=e),placeholder:"请输入验证码"},null,8,["modelValue"])])),_:1}),(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(u,{modelValue:p.value,"onUpdate:modelValue":n[5]||(n[5]=e=>p.value=e),type:"password",placeholder:"请输入新密码"},null,8,["modelValue"])])),_:1}),(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(h,{type:"primary",onClick:K,loading:(0,r.R1)(V)},{default:(0,a.k6)((()=>[(0,a.eW)("提交")])),_:1},8,["loading"])])),_:1}),(0,a.bF)(h,{type:"text",onClick:n[6]||(n[6]=e=>s.value=!0)},{default:(0,a.k6)((()=>[(0,a.eW)("返回登录")])),_:1})])),_:1})),s.value?((0,a.uX)(),(0,a.CE)("div",F,[(0,a.bF)(m,{type:"primary",target:"_blank",onClick:A},{default:(0,a.k6)((()=>[(0,a.eW)("免责声明")])),_:1}),(0,a.bF)(m,{type:"primary",onClick:n[7]||(n[7]=e=>s.value=!1)},{default:(0,a.k6)((()=>[(0,a.eW)("忘记密码")])),_:1})])):(0,a.Q3)("",!0)])),_:1})])),_:1})}}};const R=S;var T=R}}]);
//# sourceMappingURL=login.9e06d296.js.map