import{g as H,d as F,E as T,_ as R,r as S,o as x,e as L,w as g,b as m,f as h,a as C,u as b,h as B,t as q,i as J,j as Y}from"./index-C8NV8vGo.js";import{i as I,A as G,B as W,D as K,a as Z,M as Q,S as X}from"./request-CtygJrjG.js";import{a as D}from"./address-w6vdAG-M.js";var E={exports:{}},$={exports:{}};(function(){var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a={rotl:function(s,i){return s<<i|s>>>32-i},rotr:function(s,i){return s<<32-i|s>>>i},endian:function(s){if(s.constructor==Number)return a.rotl(s,8)&16711935|a.rotl(s,24)&4278255360;for(var i=0;i<s.length;i++)s[i]=a.endian(s[i]);return s},randomBytes:function(s){for(var i=[];s>0;s--)i.push(Math.floor(Math.random()*256));return i},bytesToWords:function(s){for(var i=[],d=0,u=0;d<s.length;d++,u+=8)i[u>>>5]|=s[d]<<24-u%32;return i},wordsToBytes:function(s){for(var i=[],d=0;d<s.length*32;d+=8)i.push(s[d>>>5]>>>24-d%32&255);return i},bytesToHex:function(s){for(var i=[],d=0;d<s.length;d++)i.push((s[d]>>>4).toString(16)),i.push((s[d]&15).toString(16));return i.join("")},hexToBytes:function(s){for(var i=[],d=0;d<s.length;d+=2)i.push(parseInt(s.substr(d,2),16));return i},bytesToBase64:function(s){for(var i=[],d=0;d<s.length;d+=3)for(var u=s[d]<<16|s[d+1]<<8|s[d+2],c=0;c<4;c++)d*8+c*6<=s.length*8?i.push(f.charAt(u>>>6*(3-c)&63)):i.push("=");return i.join("")},base64ToBytes:function(s){s=s.replace(/[^A-Z0-9+\/]/ig,"");for(var i=[],d=0,u=0;d<s.length;u=++d%4)u!=0&&i.push((f.indexOf(s.charAt(d-1))&Math.pow(2,-2*u+8)-1)<<u*2|f.indexOf(s.charAt(d))>>>6-u*2);return i}};$.exports=a})();var j=$.exports,V={utf8:{stringToBytes:function(f){return V.bin.stringToBytes(unescape(encodeURIComponent(f)))},bytesToString:function(f){return decodeURIComponent(escape(V.bin.bytesToString(f)))}},bin:{stringToBytes:function(f){for(var a=[],s=0;s<f.length;s++)a.push(f.charCodeAt(s)&255);return a},bytesToString:function(f){for(var a=[],s=0;s<f.length;s++)a.push(String.fromCharCode(f[s]));return a.join("")}}},N=V;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var ee=function(f){return f!=null&&(M(f)||te(f)||!!f._isBuffer)};function M(f){return!!f.constructor&&typeof f.constructor.isBuffer=="function"&&f.constructor.isBuffer(f)}function te(f){return typeof f.readFloatLE=="function"&&typeof f.slice=="function"&&M(f.slice(0,0))}(function(){var f=j,a=N.utf8,s=ee,i=N.bin,d=function(u,c){u.constructor==String?c&&c.encoding==="binary"?u=i.stringToBytes(u):u=a.stringToBytes(u):s(u)?u=Array.prototype.slice.call(u,0):!Array.isArray(u)&&u.constructor!==Uint8Array&&(u=u.toString());for(var n=f.bytesToWords(u),w=u.length*8,r=1732584193,t=-271733879,e=-1732584194,o=271733878,l=0;l<n.length;l++)n[l]=(n[l]<<8|n[l]>>>24)&16711935|(n[l]<<24|n[l]>>>8)&4278255360;n[w>>>5]|=128<<w%32,n[(w+64>>>9<<4)+14]=w;for(var p=d._ff,v=d._gg,y=d._hh,_=d._ii,l=0;l<n.length;l+=16){var P=r,k=t,z=e,U=o;r=p(r,t,e,o,n[l+0],7,-680876936),o=p(o,r,t,e,n[l+1],12,-389564586),e=p(e,o,r,t,n[l+2],17,606105819),t=p(t,e,o,r,n[l+3],22,-1044525330),r=p(r,t,e,o,n[l+4],7,-176418897),o=p(o,r,t,e,n[l+5],12,1200080426),e=p(e,o,r,t,n[l+6],17,-1473231341),t=p(t,e,o,r,n[l+7],22,-45705983),r=p(r,t,e,o,n[l+8],7,1770035416),o=p(o,r,t,e,n[l+9],12,-1958414417),e=p(e,o,r,t,n[l+10],17,-42063),t=p(t,e,o,r,n[l+11],22,-1990404162),r=p(r,t,e,o,n[l+12],7,1804603682),o=p(o,r,t,e,n[l+13],12,-40341101),e=p(e,o,r,t,n[l+14],17,-1502002290),t=p(t,e,o,r,n[l+15],22,1236535329),r=v(r,t,e,o,n[l+1],5,-165796510),o=v(o,r,t,e,n[l+6],9,-1069501632),e=v(e,o,r,t,n[l+11],14,643717713),t=v(t,e,o,r,n[l+0],20,-373897302),r=v(r,t,e,o,n[l+5],5,-701558691),o=v(o,r,t,e,n[l+10],9,38016083),e=v(e,o,r,t,n[l+15],14,-660478335),t=v(t,e,o,r,n[l+4],20,-405537848),r=v(r,t,e,o,n[l+9],5,568446438),o=v(o,r,t,e,n[l+14],9,-1019803690),e=v(e,o,r,t,n[l+3],14,-187363961),t=v(t,e,o,r,n[l+8],20,1163531501),r=v(r,t,e,o,n[l+13],5,-1444681467),o=v(o,r,t,e,n[l+2],9,-51403784),e=v(e,o,r,t,n[l+7],14,1735328473),t=v(t,e,o,r,n[l+12],20,-1926607734),r=y(r,t,e,o,n[l+5],4,-378558),o=y(o,r,t,e,n[l+8],11,-2022574463),e=y(e,o,r,t,n[l+11],16,1839030562),t=y(t,e,o,r,n[l+14],23,-35309556),r=y(r,t,e,o,n[l+1],4,-1530992060),o=y(o,r,t,e,n[l+4],11,1272893353),e=y(e,o,r,t,n[l+7],16,-155497632),t=y(t,e,o,r,n[l+10],23,-1094730640),r=y(r,t,e,o,n[l+13],4,681279174),o=y(o,r,t,e,n[l+0],11,-358537222),e=y(e,o,r,t,n[l+3],16,-722521979),t=y(t,e,o,r,n[l+6],23,76029189),r=y(r,t,e,o,n[l+9],4,-640364487),o=y(o,r,t,e,n[l+12],11,-421815835),e=y(e,o,r,t,n[l+15],16,530742520),t=y(t,e,o,r,n[l+2],23,-995338651),r=_(r,t,e,o,n[l+0],6,-198630844),o=_(o,r,t,e,n[l+7],10,1126891415),e=_(e,o,r,t,n[l+14],15,-1416354905),t=_(t,e,o,r,n[l+5],21,-57434055),r=_(r,t,e,o,n[l+12],6,1700485571),o=_(o,r,t,e,n[l+3],10,-1894986606),e=_(e,o,r,t,n[l+10],15,-1051523),t=_(t,e,o,r,n[l+1],21,-2054922799),r=_(r,t,e,o,n[l+8],6,1873313359),o=_(o,r,t,e,n[l+15],10,-30611744),e=_(e,o,r,t,n[l+6],15,-1560198380),t=_(t,e,o,r,n[l+13],21,1309151649),r=_(r,t,e,o,n[l+4],6,-145523070),o=_(o,r,t,e,n[l+11],10,-1120210379),e=_(e,o,r,t,n[l+2],15,718787259),t=_(t,e,o,r,n[l+9],21,-343485551),r=r+P>>>0,t=t+k>>>0,e=e+z>>>0,o=o+U>>>0}return f.endian([r,t,e,o])};d._ff=function(u,c,n,w,r,t,e){var o=u+(c&n|~c&w)+(r>>>0)+e;return(o<<t|o>>>32-t)+c},d._gg=function(u,c,n,w,r,t,e){var o=u+(c&w|n&~w)+(r>>>0)+e;return(o<<t|o>>>32-t)+c},d._hh=function(u,c,n,w,r,t,e){var o=u+(c^n^w)+(r>>>0)+e;return(o<<t|o>>>32-t)+c},d._ii=function(u,c,n,w,r,t,e){var o=u+(n^(c|~w))+(r>>>0)+e;return(o<<t|o>>>32-t)+c},d._blocksize=16,d._digestsize=16,E.exports=function(u,c){if(u==null)throw new Error("Illegal argument "+u);var n=f.wordsToBytes(d(u,c));return c&&c.asBytes?n:c&&c.asString?i.bytesToString(n):f.bytesToHex(n)}})();var oe=E.exports;const re=H(oe),A=f=>re(f).toLowerCase(),ne=(f,a)=>{const s=A(a),i={appVersion:G,brand:W,deviceToken:K,deviceType:Z,mobileType:Q,password:s,sysVersion:X,userPhone:f};return I.post(D.login,i)},se=f=>I.get(D.sendSms,{params:{phoneNum:f}}),le=(f,a,s)=>{const i=A(a),d={password:i,passwordRes:i,userPhone:f,code:s};return I.post(D.updatePassword,d)};function O(){const f=F(!1),a=F(!1);return{LoginLoading:f,isLoggedIn:a,fetchLogin:async(d,u)=>{f.value=!0;try{const c=await ne(d,u);if(c.data.code===1e4){const n=JSON.parse(localStorage.getItem("accounts")||"[]");n.push({phone:d,password:u}),localStorage.setItem("accounts",JSON.stringify(n));const w=c.data.response.oauthToken.token,r=c.data.response;return localStorage.setItem("token",w),localStorage.setItem("userData",JSON.stringify(r)),T.success("登录成功"),a.value=!0,!0}else return T.error("登录失败: "+c.data.msg),!1}catch(c){return T.error("登录失败: "+c.message),!1}finally{f.value=!1}},LoginState:()=>{const d=localStorage.getItem("token"),u=localStorage.getItem("userData"),c=u?JSON.parse(u):null;return!(!d||!c)}}}function ae(){const f=F(!1),a=F("获取验证码"),s=F(!1),i=(u,c,n)=>{let w=u;const r=setInterval(()=>{w<=0?(clearInterval(r),n()):(w-=1,c(w))},1e3)};return{SmsLoading:f,codeText:a,codeDisabled:s,fetchSendSMS:async u=>{f.value=!0,a.value="正在发送";try{const c=await se(u);c.data.code===1e4?T.success("验证码发送成功"):T.error("验证码发送失败: "+c.data.msg)}catch(c){T.error("验证码发送出错"+c.message),a.value="获取验证码",s.value=!1}finally{f.value=!1,i(60,c=>{a.value=`${c} 秒后重新获取`,s.value=!0},()=>{a.value="获取验证码",s.value=!1})}}}}function ue(){const f=F(!1);return{ResetLoading:f,fetchResetPassword:async(s,i,d)=>{f.value=!0;try{const u=await le(s,i,d);return u.data.code===1e4?(T.success("密码重置成功"),!0):(T.error("密码重置失败: "+u.data.msg),!1)}catch(u){return console.error("密码重置出错: "+u.message),!1}finally{f.value=!1}}}}const ie={};function de(f,a){const s=S("el-text"),i=S("el-link"),d=S("el-space"),u=S("el-button"),c=S("el-form");return x(),L(c,{class:"DisclaimerForm"},{default:g(()=>[m(d,{direction:"vertical"},{default:g(()=>[m(s,{tag:"b",size:"large"},{default:g(()=>a[1]||(a[1]=[h("免责声明")])),_:1}),m(s,null,{default:g(()=>a[2]||(a[2]=[h("使用本项目所产生的任何后果，用户需自行承担。")])),_:1}),m(s,null,{default:g(()=>a[3]||(a[3]=[h("本项目仅供学习交流使用，不得用于任何商业用途。")])),_:1}),m(s,null,{default:g(()=>a[4]||(a[4]=[h("使用本项目即代表你同意以下声明：")])),_:1}),m(s,{size:"small"},{default:g(()=>a[5]||(a[5]=[h("1. 本项目不对任何数据的准确性、完整性或适用性做出任何保证。")])),_:1}),m(s,{size:"small"},{default:g(()=>a[6]||(a[6]=[h("2. 用户在使用本项目过程中，应遵守相关法律法规，不得利用本项目从事任何违法活动。")])),_:1}),m(s,{size:"small"},{default:g(()=>a[7]||(a[7]=[h("3. 本项目的开发者不对因使用本项目而产生的任何直接或间接损失承担责任。")])),_:1}),m(s,{size:"small"},{default:g(()=>a[8]||(a[8]=[h("4. 用户应自行承担因使用本项目而可能产生的所有风险。")])),_:1}),m(s,{size:"small"},{default:g(()=>a[9]||(a[9]=[h("5. 本项目的开发者保留随时修改或终止本项目的权利。")])),_:1}),m(i,{type:"primary",href:f.githubURL,target:"_blank"},{default:g(()=>a[10]||(a[10]=[C("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2307",width:"20",height:"20"},[C("path",{d:"M64 512c0 195.2 124.8 361.6 300.8 422.4 22.4 6.4 19.2-9.6 19.2-22.4v-76.8c-134.4 16-140.8-73.6-150.4-89.6-19.2-32-60.8-38.4-48-54.4 32-16 64 3.2 99.2 57.6 25.6 38.4 76.8 32 105.6 25.6 6.4-22.4 19.2-44.8 35.2-60.8-144-22.4-201.6-108.8-201.6-211.2 0-48 16-96 48-131.2-22.4-60.8 0-115.2 3.2-121.6 57.6-6.4 118.4 41.6 124.8 44.8 32-9.6 70.4-12.8 112-12.8 41.6 0 80 6.4 112 12.8 12.8-9.6 67.2-48 121.6-44.8 3.2 6.4 25.6 57.6 6.4 118.4 32 38.4 48 83.2 48 131.2 0 102.4-57.6 188.8-201.6 214.4 22.4 22.4 38.4 54.4 38.4 92.8v112c0 9.6 0 19.2 16 19.2C832 876.8 960 710.4 960 512c0-246.4-201.6-448-448-448S64 265.6 64 512z",fill:"#040000","p-id":"2308"})],-1)])),_:1},8,["href"])]),_:1}),m(u,{type:"primary",onClick:a[0]||(a[0]=n=>f.$emit("closeDisclaimer"))},{default:g(()=>a[11]||(a[11]=[h("返回登录")])),_:1})]),_:1})}const fe=R(ie,[["render",de]]),ce={class:"footer-links"},pe={__name:"LoginForm",setup(f){const a=b(),s=F({phone:"",password:""}),i=F(null),{LoginLoading:d,fetchLogin:u}=O(),c={phone:[{required:!0,message:"请输入正确的手机号码",trigger:"blur"},{validator:(t,e,o)=>{/^1\d{10}$/.test(e)===!1?o(new Error("手机号格式错误")):o()},trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},n=t=>/^1[3-9]\d{9}$/.test(t)?!0:(T.error("请输入正确的手机号"),!1),w=()=>{i.value&&i.value.validate(async t=>{if(t)n(s.value.phone)&&await u(s.value.phone,s.value.password)&&a.push("/dashboard");else return console.log("error submit!!"),!1})},r=()=>{a.push("/")};return(t,e)=>{const o=S("el-input"),l=S("el-form-item"),p=S("el-button"),v=S("el-link"),y=S("el-form");return x(),L(y,{model:s.value,rules:c,ref_key:"loginFormRef",ref:i},{default:g(()=>[m(l,{prop:"phone"},{default:g(()=>[m(o,{modelValue:s.value.phone,"onUpdate:modelValue":e[0]||(e[0]=_=>s.value.phone=_),placeholder:"请输入手机号",clearable:""},null,8,["modelValue"])]),_:1}),m(l,{prop:"password"},{default:g(()=>[m(o,{modelValue:s.value.password,"onUpdate:modelValue":e[1]||(e[1]=_=>s.value.password=_),type:"password",placeholder:"请输入密码","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),m(l,null,{default:g(()=>[m(p,{type:"primary",onClick:w,loading:B(d)},{default:g(()=>e[4]||(e[4]=[h("立即登录")])),_:1},8,["loading"])]),_:1}),m(l,null,{default:g(()=>[m(p,{type:"default",onClick:r},{default:g(()=>e[5]||(e[5]=[h("返回主页")])),_:1})]),_:1}),C("div",ce,[m(v,{type:"primary",onClick:e[2]||(e[2]=_=>t.$emit("showDisclaimer"))},{default:g(()=>e[6]||(e[6]=[h("免责声明")])),_:1}),m(v,{type:"primary",onClick:e[3]||(e[3]=_=>t.$emit("showResetPassword"))},{default:g(()=>e[7]||(e[7]=[h("忘记密码")])),_:1})])]),_:1},8,["model"])}}},me=R(pe,[["__scopeId","data-v-8f149f6c"]]),ge={__name:"ResetPasswordForm",setup(f){const a=F({phoneNum:"",newPassword:"",smsCode:""}),s=F(null),{SmsLoading:i,codeText:d,codeDisabled:u,fetchSendSMS:c}=ae(),{ResetLoading:n,fetchResetPassword:w}=ue(),r={phoneNum:[{required:!0,message:"请输入正确的手机号码",trigger:"blur"},{validator:(l,p,v)=>{/^1\d{10}$/.test(p)===!1?v(new Error("手机号格式错误")):v()},trigger:"blur"}],smsCode:[{required:!0,message:"请输入验证码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"}]},t=l=>/^1[3-9]\d{9}$/.test(l)?!0:(T.error("请输入正确的手机号"),!1),e=()=>{s.value&&s.value.validateField("phoneNum",l=>{if(l)t(a.value.phoneNum)&&c(a.value.phoneNum);else return console.log("error submit!!"),!1})},o=async()=>{s.value&&s.value.validate(async l=>{if(l)t(a.value.phoneNum)&&await w(a.value.phoneNum,a.value.newPassword,a.value.smsCode)&&(a.value.phoneNum="",a.value.newPassword="",a.value.smsCode="");else return console.log("error submit!!"),!1})};return(l,p)=>{const v=S("el-input"),y=S("el-button"),_=S("el-form-item"),P=S("el-form");return x(),L(P,{model:a.value,rules:r,ref_key:"resetFormRef",ref:s},{default:g(()=>[m(_,{prop:"phoneNum"},{default:g(()=>[m(v,{modelValue:a.value.phoneNum,"onUpdate:modelValue":p[0]||(p[0]=k=>a.value.phoneNum=k),placeholder:"请输入手机号",class:"phone-input",clearable:""},null,8,["modelValue"]),m(y,{type:"primary",onClick:e,disabled:B(u),loading:B(i),block:"",class:"sms-button"},{default:g(()=>[h(q(B(d)),1)]),_:1},8,["disabled","loading"])]),_:1}),m(_,{prop:"smsCode"},{default:g(()=>[m(v,{modelValue:a.value.smsCode,"onUpdate:modelValue":p[1]||(p[1]=k=>a.value.smsCode=k),placeholder:"请输入验证码",clearable:""},null,8,["modelValue"])]),_:1}),m(_,{prop:"newPassword"},{default:g(()=>[m(v,{modelValue:a.value.newPassword,"onUpdate:modelValue":p[2]||(p[2]=k=>a.value.newPassword=k),type:"password",placeholder:"请输入新密码","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),m(_,null,{default:g(()=>[m(y,{type:"primary",onClick:o,loading:B(n)},{default:g(()=>p[4]||(p[4]=[h("提交")])),_:1},8,["loading"])]),_:1}),m(y,{type:"text",onClick:p[3]||(p[3]=k=>l.$emit("backToLogin"))},{default:g(()=>p[5]||(p[5]=[h("返回登录")])),_:1})]),_:1},8,["model"])}}},ye={__name:"Login",setup(f){const a=b(),s=F(!0),i=F(!1),{isLoggedIn:d,LoginState:u}=O(),c=()=>{s.value=!1,i.value=!0},n=()=>{s.value=!0,i.value=!1},w=()=>{s.value=!1,i.value=!1},r=()=>{s.value=!0,i.value=!1},t=()=>{a.push("/dashboard")};return J(()=>{d.value&&t()}),Y(async()=>{await u()&&t()}),(e,o)=>{const l=S("el-header"),p=S("el-main"),v=S("el-container");return x(),L(v,null,{default:g(()=>[m(l,null,{default:g(()=>o[0]||(o[0]=[C("h1",null,"Byerun",-1)])),_:1}),m(p,null,{default:g(()=>[i.value?(x(),L(fe,{key:0,onCloseDisclaimer:n})):s.value?(x(),L(me,{key:1,onShowDisclaimer:c,onShowResetPassword:w})):(x(),L(ge,{key:2,onBackToLogin:r}))]),_:1})]),_:1})}}};export{ye as default};
