import{d as i,E as y,_ as z,i as H,j as _,w as t,u as L,r as u,o as l,b as a,f as R,a as j,c as x,p as J,F as O,m as D,e as m,q as M,s as P,v as A,x as G,y as K,t as p}from"./index-CZ6jN7u5.js";import{q as Q}from"./run-mLDDUUkt.js";import"./request-PAA82owp.js";import"./address-w6vdAG-M.js";function U(){const g=i([]);return{runRecord:g,fetchRunRecord:async(h,b)=>{try{const e=await Q(h,b);if(e.data.code===1e4)e.data.response.length===0?y.success("暂无跑步记录"):g.value=[...g.value,...e.data.response];else return y.error(e.data.msg),{code:e.data.code,msg:e.data.msg,response:[]};return e.data}catch(e){return y.error("获取跑步记录出错: "+e.message),{code:500,msg:"获取跑步记录出错",response:[]}}}}}const W={key:0,class:"loading-indicator"},X={__name:"RunRecord",setup(g){const{runRecord:N,fetchRunRecord:h}=U(),b=i(JSON.parse(localStorage.getItem("userData"))||null),e=i([]),d=i(!1),w=i(1),I=i(15),B=L(),v=i(!1),C=()=>{window.history.go(-1)},S=async()=>{if(v.value)return;d.value=!0;const n=await h(w.value,I.value);d.value=!1,n&&n.code===1e4?(n.response.length<I.value&&(v.value=!0),e.value=[...e.value,...n.response]):(v.value=!0,e.value.length===0&&y.success("暂无跑步记录"))},T=n=>{const{scrollTop:s,clientHeight:r,scrollHeight:c}=n.target;s+r>=c-10&&V()},V=()=>{!d.value&&!v.value&&(w.value+=1,S())},q=(n,s)=>{const r=n/(s/1e3),c=Math.floor(r),f=Math.round((r-c)*60);return`${c}'${f<10?"0":""}${f}''`};return H(()=>{b.value?S():B.push("/home")}),(n,s)=>{const r=u("el-icon"),c=u("el-result"),f=u("el-main"),k=u("el-descriptions-item"),E=u("el-descriptions"),F=u("el-button"),$=u("el-container");return l(),_($,null,{default:t(()=>[d.value&&e.value.length===0?(l(),_(f,{key:0},{default:t(()=>[a(c,null,{"sub-title":t(()=>[a(r,{class:"is-loading"},{default:t(()=>[a(R(M))]),_:1})]),extra:t(()=>s[0]||(s[0]=[])),_:1})]),_:1})):(l(),_(f,{key:1},{default:t(()=>[j("div",{class:"scroll-container",onScroll:T},[(l(!0),x(O,null,J(e.value,o=>(l(),x("div",{key:o.recordId},[(l(),_(E,{class:"margin-top",key:o.recordId,column:1,border:""},{title:t(()=>[a(r,{style:P({color:o.defeatedInfo==="有效跑步"?"blue":"red"})},{default:t(()=>[(l(),_(A(o.defeatedInfo==="有效跑步"?R(G):R(K))))]),_:2},1032,["style"]),m(" "+p(o.defeatedInfo)+" - "+p(o.createTime),1)]),default:t(()=>[a(k,{label:"跑步时长"},{default:t(()=>[m(p(o.runTime)+" 分钟 ",1)]),_:2},1024),a(k,{label:"跑步里程"},{default:t(()=>[m(p((o.runDistance/1e3).toFixed(2))+" 公里 ",1)]),_:2},1024),a(k,{label:"平均配速"},{default:t(()=>[m(p(q(o.runTime,o.runDistance)),1)]),_:2},1024)]),_:2},1024))]))),128)),d.value?(l(),x("div",W,[a(r,{class:"is-loading"},{default:t(()=>[a(R(M))]),_:1})])):D("",!0)],32),!d.value&&e.value.length===0?(l(),_(c,{key:0,icon:"success","sub-title":"暂无跑步记录"},{extra:t(()=>s[1]||(s[1]=[])),_:1})):D("",!0)]),_:1})),a(F,{onClick:C},{default:t(()=>s[2]||(s[2]=[m("返回")])),_:1})]),_:1})}}},se=z(X,[["__scopeId","data-v-c4e2eb66"]]);export{se as default};
